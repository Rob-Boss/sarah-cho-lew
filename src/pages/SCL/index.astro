---
import CurtainReveal from "../../components/scl/CurtainReveal.svelte";
import PuppetTheater from "../../components/scl/PuppetTheater.svelte";
import StageFrame from "../../components/scl/StageFrame.svelte";
import ProjectSlide from "../../components/scl/ProjectSlide.svelte";
import FeedIndicators from "../../components/scl/FeedIndicators.svelte";
import Navbar from "../../components/scl/Navbar.svelte";
import LoadingOverlay from "../../components/scl/LoadingOverlay.svelte";
import { projects } from "../../data/projects";
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Sarah Cho Lew - Director</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap"
            rel="stylesheet"
        />
    </head>
    <body>
        <LoadingOverlay client:load />
        <Navbar client:load />

        <main class="stage-feed">
            <!-- Slide 1: Main Reel -->
            <section class="feed-slide reel-slide">
                <div class="hero-overlay">
                    <h1 class="hero-headline">
                        <span class="line line-1">Director</span>
                        <span class="line line-2">Sarah Lew</span>
                    </h1>
                </div>
                <div class="theater-wrapper">
                    <PuppetTheater client:load />
                </div>
                <div class="scroll-indicator">
                    <span>Scroll for Projects</span>
                    <div class="chevron">â†“</div>
                </div>
            </section>

            <!-- Project Slides -->
            {
                projects.map((project, index) => (
                    <section class="feed-slide">
                        <ProjectSlide
                            project={project}
                            index={index}
                            client:load
                        />
                    </section>
                ))
            }
        </main>

        <CurtainReveal client:load />
        <FeedIndicators totalSlides={projects.length + 1} client:load />
        <StageFrame client:load />
    </body>
</html>

<style>
    /* Sarah Cho Lew Palette */
    :root {
        --scl-mustard: #e8b830;
        --scl-teal: #3a9dad;
        --scl-teal-deep: #1d6068;
        --scl-rust: #c44a2d;
        --scl-cream: #f5f0e0;
        --scl-brown: #5c4a3d;
        --scl-curtain-width: 25vw; /* Aperture control */
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: "Fredoka", sans-serif;
        background: var(--scl-mustard);
        color: var(--scl-teal-deep);
        height: 100dvh;
        width: 100vw;
        overflow: hidden;
        position: fixed; /* Prevent bouncy scrolling on mobile body */
        touch-action: none; /* Let the feed handle all gestures */

        /* Finer paper grain */
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.2' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        background-size: 100px 100px;
        background-blend-mode: soft-light;
    }

    .stage-feed {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        height: 100dvh;
        width: 100vw;
        overflow-y: auto; /* Use auto for natural scroll behavior */
        -webkit-overflow-scrolling: touch;
        scroll-snap-type: y mandatory;
        scrollbar-width: none; /* Hide scrollbar for Firefox */
        -ms-overflow-style: none; /* Hide scrollbar for IE/Edge */
        z-index: 1; /* Lowest positive integer */
        isolation: isolate; /* Trap 3D children in this context */
        /* Padding matches curtain width to center the "aperture" content. 
           Top padding accounts for the 60px navbar. */
        padding: 60px var(--scl-curtain-width) 0;
        touch-action: pan-y;
    }

    .stage-feed::-webkit-scrollbar {
        display: none; /* Hide scrollbar for Chrome/Safari */
    }

    .feed-slide {
        height: 100vh;
        width: 100%; /* Take up available width between padding */
        scroll-snap-align: start;
        scroll-snap-stop: always;
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    /* Reel Slide Styling */
    .reel-slide {
        padding: 0 4vw;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    .hero-headline {
        margin-top: 4vh; /* Clear the top curtain valance */
        margin-bottom: 0; /* Remove gap between title and theater */
        display: flex;
        flex-direction: column;
        align-items: center;
        z-index: 5; /* Ensure title sits above theater if they overlap */
        position: relative;
    }

    .line {
        display: block;
        font-weight: 700;
        text-transform: uppercase;
        line-height: 0.85;
    }

    .line-1 {
        /* Use vmin to respect height constraints on wide screens */
        font-size: clamp(2rem, 6vmin, 5rem);
        color: var(--scl-teal-deep);
        transform: rotate(-2deg);
        text-shadow: 4px 4px 0 white;
    }

    .line-2 {
        /* Use vmin to respect height on wide screens */
        font-size: clamp(3rem, 12vmin, 10rem);
        color: var(--scl-rust);
        margin-top: -0.1em;
        transform: rotate(2deg);
        text-shadow: 8px 8px 0 white;
    }

    .theater-wrapper {
        z-index: 1;
        width: 100%;
        max-width: 900px;
        display: flex;
        justify-content: center;
        transform: scale(0.75); /* Smaller base scale */
        margin-top: -2vh; /* Tuck theater under title slightly */
        /* Subtle wobble for the theater frame */
        animation: theaterHold 6s ease-in-out infinite;
    }

    @keyframes theaterHold {
        0%,
        100% {
            transform: scale(0.75) rotate(-0.5deg);
        }
        50% {
            transform: scale(0.76) rotate(0.5deg);
        }
    }

    .scroll-indicator {
        position: absolute;
        bottom: 8vh; /* Lift up */
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        color: var(--scl-teal-deep);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        font-size: 0.8rem;
        animation: bounce 2s infinite;
        opacity: 0.6;
    }

    @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
            transform: translateY(0);
        }
        40% {
            transform: translateY(-10px);
        }
        60% {
            transform: translateY(-5px);
        }
    }

    @media (max-width: 768px) {
        .reel-slide {
            padding: 5vh 10vw;
        }
        .theater-wrapper {
            transform: scale(0.65);
        }
        .line-1 {
            font-size: clamp(2rem, 8vw, 4rem);
        }
        .line-2 {
            font-size: clamp(3rem, 15vw, 8rem);
        }
    }

    /* Vertical Constraint Handling (Landscape Mobile / Laptops) */
    @media (max-height: 850px) {
        .theater-wrapper {
            transform: scale(0.6);
            margin-top: -4vh;
        }
        .line-2 {
            font-size: 10vmin; /* Force smaller on short screens */
        }
    }
</style>
